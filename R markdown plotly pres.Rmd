---
title: "R markdown and Plotly - assignment"
author: "Bert Lijnen"
date: "20 September 2017"
output: slidy_presentation
---
# Data description

The dataset comprises segmentation segmentation data of 200 customers. The variables in this dataset are:

- `age`  
- `gender`  
- `income`   
- `ownHome`: do subjects own or rent a home?
- `subscribe`: have respondents subscribed to the offered service or not?
- `Segment`: each of the 200 subjects have been assigned to one of the following segments: *Moving up*, *Suburb mix*, *Travelers*, *Urban hip*.

We download the required libraries and the dataset

```{r setup, include=FALSE}
library(plotly)
seg.df<-read.csv("http://goo.gl/qw303p")
```

# Data summary

```{r message=FALSE, warning=FALSE}
knitr::kable(summary(seg.df))
knitr::kable(head(seg.df))
```

# Bar chart: number of subscribers by segment

```{r plot}
p1<-plot_ly(x=c("Moving up", "Suburb mix", "Travelers", "Urban hip"), 
            y=c(14,6,10,10), type="bar", name="subscribers")%>%
         add_trace(y=c(56,94,70,40), name="No subscribers")%>%
         layout(title="Number of subscribers by segment", 
                yaxis=list(title="Count", range=c(0,100)), 
                xaxis=list(title="Segment"), 
                barmode="group")
htmlwidgets::saveWidget(as_widget(p1), file = "barchart.html")
```

<iframe src="barchart.html" style="position:absolute;height:70%;width:100%"></iframe>

# Income by Age ans Segment with fitted least squares regression line

```{r plot2}
seg.df$age<-as.integer(seg.df$age)
fit<-lm(income~age, data=seg.df)
p2<-plot_ly(data=seg.df, x=~age, y=~income, color=~Segment,
            type="scatter", mode="markers")%>%
        add_lines(x=~age, y=fitted(fit), showlegend=FALSE)%>%
        layout(title="Income by age")
htmlwidgets::saveWidget(as_widget(p2), file = "scatter.html")
```

<iframe src="scatter.html" style="position:absolute;height:70%;width:100%"></iframe>
